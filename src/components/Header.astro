---
const currentPath = Astro.url.pathname;
---

<header class="bg-[#F1E7C7] border-b-4 border-black sticky top-0 z-50">
  <div
    class="relative max-w-6xl mx-auto flex items-center lg:items-end justify-between
           px-6 sm:px-8 lg:px-12 pt-4 lg:pt-5 pb-2"
  >
    <!-- Barre verticale dans le header -->
    <div
      class="pointer-events-none absolute inset-y-0 left-[-22px] border-l-4 border-black"
    ></div>

    <!-- Logo aligné avec la barre comme sur Figma -->
    <a href="/" class="flex items-center pl-0">
      <img src="/logo.png" alt="Logo Alexandre Demling" class="h-16 w-auto" />
    </a>

    <!-- NAVIGATION DESKTOP (inchangée) -->
    <nav class="hidden lg:flex gap-20 text-2xl heading-font pb-1 pr-4">
      <a
        href="/"
        class={`hover:underline ${currentPath === '/' ? 'underline' : ''}`}
      >
        Profil
      </a>
      <a
        href="/projets"
        class={`hover:underline ${currentPath.startsWith('/projets') ? 'underline' : ''}`}
      >
        Projet
      </a>
      <a
        href="/contact"
        class={`hover:underline ${currentPath.startsWith('/contact') ? 'underline' : ''}`}
      >
        Contact
      </a>
    </nav>

    <!-- BOUTON BURGER MOBILE -->
    <button
      type="button"
      class="lg:hidden flex flex-col justify-between h-6 w-8 relative z-50"
      aria-label="Ouvrir le menu"
      aria-expanded="false"
      data-menu-toggle
    >
      <span class="block h-[2px] w-full bg-black"></span>
      <span class="block h-[2px] w-full bg-black"></span>
      <span class="block h-[2px] w-full bg-black"></span>
    </button>
  </div>

  <!-- MENU MOBILE SLIDE -->
  <div
    class="lg:hidden fixed top-0 right-0 h-full w-3/4 max-w-xs bg-[#F1E7C7] border-l-4 border-black
           transform translate-x-full transition-transform duration-300 ease-out z-40"
    data-menu-panel
  >
    <!-- petite barre en haut alignée avec la barre du header -->
<div class="border-b-4 border-black h-[92px] flex items-center px-6">
  <span class="heading-font text-xl">Navigation</span>
</div>

    <nav class="flex flex-col gap-6 heading-font text-2xl px-6 pt-8">
      <a
        href="/"
        class={`hover:underline ${currentPath === '/' ? 'underline' : ''}`}
        data-menu-close
      >
        Profil
      </a>
      <a
        href="/projets"
        class={`hover:underline ${currentPath.startsWith('/projets') ? 'underline' : ''}`}
        data-menu-close
      >
        Projets
      </a>
      <a
        href="/contact"
        class={`hover:underline ${currentPath.startsWith('/contact') ? 'underline' : ''}`}
        data-menu-close
      >
        Contact
      </a>
    </nav>
  </div>
</header>

<style>
  .heading-font {
    font-family: var(--font-heading);
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const toggle = document.querySelector("[data-menu-toggle]");
    const panel = document.querySelector("[data-menu-panel]");
    const links = panel?.querySelectorAll("[data-menu-close]") ?? [];

    if (!toggle || !panel) return;

    const toggleMenu = () => {
      const isOpen = panel.classList.contains("translate-x-0");

      panel.classList.toggle("translate-x-0", !isOpen);
      panel.classList.toggle("translate-x-full", isOpen);
      toggle.setAttribute("aria-expanded", (!isOpen).toString());
    };

    toggle.addEventListener("click", toggleMenu);
    links.forEach((link) => link.addEventListener("click", toggleMenu));
  });
</script>
